version: 2

models:
  - name: ratings
    description: "Fact table for ratings of coffees"
    columns:
      - name: rating_id
        description: "Primary key (record ID from Airtable)"
        data_tests:
          - unique
          - not_null
      - name: coffee_id
        description: "Foreign key for `coffees`"
        data_tests:
          - relationships:
              to: ref('coffees')
              field: coffee_id
      - name: rated_date
        description: "Date the coffee was rated"
        data_tests:
          - not_null
      - name: rating
        description: "Rating given"
        data_tests:
          - not_null
      - name: rating_age
        description: "Days since rating"
        data_tests:
          - not_null
      - name: weight
        description: "Recency-based weight given to rating (half-life of 365 days)"
        data_tests:
          - not_null
      - name: weighted_rating
        description: "Rating with weighting applied"
        data_tests:
          - not_null
